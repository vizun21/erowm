{% extends 'accounting/base.html' %}

{% block menu %}
	{% include 'accounting/menu.html' %}
{% endblock %}

{% block content %}
{% load humanize %}
<div class="row">
	<div class="col-md-6 bg-light mt-1">
		<form method="POST">
			{% csrf_token %}
			<span>년도선택</span>
			<select name="year">
				{% for y in year_range %}
				<option value="{{ y }}" {% if y == year %}selected{% endif %}>{{ y }}</option>
				{% endfor %}
			</select>
			<input type="submit" class="btn btn-primary btn-sm py-0" value="변경">
		</form>
	</div>
</div>
<div class="row mb-4">
	<div class="col-md-12">
		<center><h1 class="mt-3 mb-3">{{ year }}년 {% if budget_type == 'revenue' %}세입{% else %}세출{% endif %}결산서</h1></center>
		<div class="table-responsive">
			<table class="table table-bordered table-sm">
				<thead class="thead-light text-center th-nowrap">
					<tr>
						<th colspan="6" width="60%">과목</th>
						<th rowspan="2" class="align-middle">예산액</th>
						<th rowspan="2" class="align-middle">{% if budget_type == 'revenue' %}수납액{% elif budget_type == 'expenditure' %}지출액{% endif %}</th>
						<th rowspan="2" class="align-middle">{% if budget_type == 'revenue' %}미납액{% elif budget_type == 'expenditure' %}잔액{% endif %}</th>
						<th rowspan="2" class="align-middle">비고</th>
					</tr>
					<tr>
						<th colspan="2" width="20%">관</th>
						<th colspan="2" width="20%">항</th>
						<th colspan="2" width="20%">목</th>
					</tr>
					<tr>
						<th colspan="6">총계</th>
						<th class="text-right">{{ total_budget|intcomma }}</th>
						<th class="text-right">{{ total_sum|intcomma }}</th>
						<th class="text-right">{{ total_difference|intcomma }}</th>
						<th></th>
					</tr>
				</thead>
				<tbody class="text-center td-align-middle">
					{% for subsection in subsection_list %}
					<tr>
						<td rowspan="{{ subsection.count }}">{{ subsection.code }}00</td>
						<td rowspan="{{ subsection.count }}">{{ subsection.context }}</td>
						{% for paragraph in paragraph_list %}
						{% if paragraph.subsection == subsection %}
						<td rowspan="{{ paragraph.count }}">{{ subsection.code }}{{ paragraph.code }}0</td>
						<td rowspan="{{ paragraph.count }}">{{ paragraph.context }}</td>
						{% for item in item_list %}
						{% if item.paragraph == paragraph %}
						<td>{{ subsection.code }}{{ paragraph.code }}{{ item.code }}</td>
						<td style="white-space:nowrap;">{{ item.context }}</td>
						<td class="text-right">{{ item.total_budget|intcomma }}</td>
						<td class="text-right">{{ item.total_sum|intcomma }}</td>
						<td class="text-right">{{ item.total_difference|intcomma }}</td>
						<td></td>
					</tr></tr>
						{% endif %}
						{% endfor %}
						{% endif %}
						{% endfor %}
					{% endfor %}
				</tbody>
			</table>
		</div>
	</div>
</div>
{% endblock %}

